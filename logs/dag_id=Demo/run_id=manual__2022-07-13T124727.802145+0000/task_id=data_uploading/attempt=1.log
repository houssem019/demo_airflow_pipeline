[2022-07-13 12:48:47,415] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: Demo.data_uploading manual__2022-07-13T12:47:27.802145+00:00 [queued]>
[2022-07-13 12:48:47,790] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: Demo.data_uploading manual__2022-07-13T12:47:27.802145+00:00 [queued]>
[2022-07-13 12:48:48,130] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2022-07-13 12:48:48,134] {taskinstance.py:1357} INFO - Starting attempt 1 of 1
[2022-07-13 12:48:48,135] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2022-07-13 12:48:48,981] {taskinstance.py:1377} INFO - Executing <Task(PythonOperator): data_uploading> on 2022-07-13 12:47:27.802145+00:00
[2022-07-13 12:48:49,114] {standard_task_runner.py:52} INFO - Started process 1457 to run task
[2022-07-13 12:48:49,123] {standard_task_runner.py:79} INFO - Running: ['***', 'tasks', 'run', 'Demo', 'data_uploading', 'manual__2022-07-13T12:47:27.802145+00:00', '--job-id', '46', '--raw', '--subdir', 'DAGS_FOLDER/demo.py', '--cfg-path', '/tmp/tmpdoe9a04t', '--error-file', '/tmp/tmpvvc7pqe7']
[2022-07-13 12:48:49,125] {standard_task_runner.py:80} INFO - Job 46: Subtask data_uploading
[2022-07-13 12:48:56,105] {task_command.py:370} INFO - Running <TaskInstance: Demo.data_uploading manual__2022-07-13T12:47:27.802145+00:00 [running]> on host dbd17cae98ec
[2022-07-13 12:49:01,465] {taskinstance.py:1571} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=Demo
AIRFLOW_CTX_TASK_ID=data_uploading
AIRFLOW_CTX_EXECUTION_DATE=2022-07-13T12:47:27.802145+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=manual__2022-07-13T12:47:27.802145+00:00
[2022-07-13 12:49:04,884] {base.py:68} INFO - Using connection ID 'demo' for task execution.
[2022-07-13 12:49:06,826] {_universal.py:473} INFO - Request URL: 'http://azurite:10000/devstoreaccount1/demo/example'
Request method: 'PUT'
Request headers:
    'x-ms-blob-type': 'REDACTED'
    'Content-Length': '947'
    'If-None-Match': '*'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/octet-stream'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.8.1 Python/3.7.13 (Linux-5.10.16.3-microsoft-standard-WSL2-x86_64-with-debian-11.3)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '2e9f6298-02aa-11ed-b7e7-0242ac120009'
    'Authorization': 'REDACTED'
A body is sent with the request
[2022-07-13 12:49:13,935] {_universal.py:504} INFO - Response status: 409
Response headers:
    'Server': 'Azurite-Blob/3.18.0'
    'x-ms-error-code': 'REDACTED'
    'x-ms-request-id': '20ad281e-9440-4907-8729-e0e86d434b20'
    'content-type': 'application/xml'
    'Date': 'Wed, 13 Jul 2022 12:49:13 GMT'
    'Connection': 'keep-alive'
    'Keep-Alive': 'REDACTED'
    'Transfer-Encoding': 'chunked'
[2022-07-13 12:49:13,943] {taskinstance.py:1889} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/azure/storage/blob/_upload_helpers.py", line 105, in upload_block_blob
    **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/azure/storage/blob/_generated/operations/_block_blob_operations.py", line 228, in upload
    map_error(status_code=response.status_code, response=response, error_map=error_map)
  File "/home/airflow/.local/lib/python3.7/site-packages/azure/core/exceptions.py", line 107, in map_error
    raise error
azure.core.exceptions.ResourceExistsError: Operation returned an invalid status 'The specified blob already exists.'
Content: <?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Error>
  <Code>BlobAlreadyExists</Code>
  <Message>The specified blob already exists.
RequestId:20ad281e-9440-4907-8729-e0e86d434b20
Time:2022-07-13T12:49:13.928Z</Message>
</Error>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/demo.py", line 23, in upload_data
    test.load_file(file_path="/opt/airflow/files/example_2.json",container_name="demo",blob_name="example")
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/microsoft/azure/hooks/wasb.py", line 259, in load_file
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/microsoft/azure/hooks/wasb.py", line 339, in upload
    return blob_client.upload_blob(data, blob_type, length=length, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/azure/core/tracing/decorator.py", line 73, in wrapper_use_tracer
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/azure/storage/blob/_blob_client.py", line 693, in upload_blob
    return upload_block_blob(**options)
  File "/home/airflow/.local/lib/python3.7/site-packages/azure/storage/blob/_upload_helpers.py", line 157, in upload_block_blob
    process_storage_error(error)
  File "/home/airflow/.local/lib/python3.7/site-packages/azure/storage/blob/_shared/response_handlers.py", line 150, in process_storage_error
    error.raise_with_traceback()
  File "/home/airflow/.local/lib/python3.7/site-packages/azure/core/exceptions.py", line 249, in raise_with_traceback
    raise super(AzureError, self).with_traceback(self.exc_traceback)
  File "/home/airflow/.local/lib/python3.7/site-packages/azure/storage/blob/_upload_helpers.py", line 105, in upload_block_blob
    **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/azure/storage/blob/_generated/operations/_block_blob_operations.py", line 228, in upload
    map_error(status_code=response.status_code, response=response, error_map=error_map)
  File "/home/airflow/.local/lib/python3.7/site-packages/azure/core/exceptions.py", line 107, in map_error
    raise error
azure.core.exceptions.ResourceExistsError: The specified blob already exists.
RequestId:20ad281e-9440-4907-8729-e0e86d434b20
Time:2022-07-13T12:49:13.928Z
ErrorCode:BlobAlreadyExists
Error:
  
Content: <?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Error>
  <Code>BlobAlreadyExists</Code>
  <Message>The specified blob already exists.
RequestId:20ad281e-9440-4907-8729-e0e86d434b20
Time:2022-07-13T12:49:13.928Z</Message>
</Error>
[2022-07-13 12:49:14,285] {taskinstance.py:1400} INFO - Marking task as FAILED. dag_id=Demo, task_id=data_uploading, execution_date=20220713T124727, start_date=20220713T124847, end_date=20220713T124914
[2022-07-13 12:49:14,743] {standard_task_runner.py:97} ERROR - Failed to execute job 46 for task data_uploading (The specified blob already exists.
RequestId:20ad281e-9440-4907-8729-e0e86d434b20
Time:2022-07-13T12:49:13.928Z
ErrorCode:BlobAlreadyExists
Error:
  
Content: <?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Error>
  <Code>BlobAlreadyExists</Code>
  <Message>The specified blob already exists.
RequestId:20ad281e-9440-4907-8729-e0e86d434b20
Time:2022-07-13T12:49:13.928Z</Message>
</Error>; 1457)
[2022-07-13 12:49:14,779] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-07-13 12:49:15,433] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
